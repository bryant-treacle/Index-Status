# Author: Bryant Treacl
# Date: 24 Jan 18
input {
    http {
        id => "elastic_health"
        port => "6000"
        tags => ["elastic-health"]
	}
}

# add a tag if the fields match the 'node status' information
filter {
    if [name] and [heap.percent] and [ram.percent] {
        mutate {
            add_tag => ["node_status"]
        }
    }
}

# add a tag if the fields match the 'index status' information
filter {
    if [index] and [docs.count] and [store.size] and [memory.total] {
        mutate {
            add_tag => ["index_status"]
        }
    }
}

# add a tag if the fields match the 'logstash status' information
filter {
    if [name] and [logstash_heap] {
        mutate {
            add_tag => ["logstash_status"]
        }
    }
}

# add a tag if the fields match the 'logstash_pipeline status' information
filter {
    if [events][in] and [events][out] {
        mutate {
            add_tag => ["logstash_pipeline_status"]
        }
    }
}
# add a tag if the fields match the 'syslog_ng_stats' information
filter {
    if [message] {
	mutate {
	    add_tag => ["syslong_ng_stats"]
	}
    }
}
